document.body.onkeydown=function(e){9===e.keyCode&&(document.body.classList.add("tab-user"),document.addEventListener("click",function(){document.body.classList.remove("tab-user")}))},document.removeEventListener("click",function(){document.body.classList.remove("tab-user")});var nav_toggle=document.getElementsByClassName("main-nav__toggle")[0],main_header=document.getElementsByClassName("main-header")[0],main_nav=document.getElementsByClassName("main-nav")[0];main_header.classList.remove("main-header--nojs"),main_nav.classList.remove("main-nav--nojs"),nav_toggle.addEventListener("click",function(){main_nav.classList.contains("main-nav--open")?(main_nav.classList.remove("main-nav--open"),main_nav.classList.add("main-nav--close"),main_header.classList.remove("main-header--open"),main_header.classList.add("main-header--close")):(main_nav.classList.remove("main-nav--close"),main_nav.classList.add("main-nav--open"),main_header.classList.remove("main-header--close"),main_header.classList.add("main-header--open"))});var bright,satur,transform_crop,edit_img_box=document.getElementsByClassName("photo-editor__picture")[0],edit_img=document.getElementById("editor_img"),sliderCrop=document.getElementById("crop"),sliderSaturate=document.getElementById("saturate"),sliderBright=document.getElementById("bright"),crop_change=!1,crop_slide=new Slider({elem:sliderCrop,filter:"crop",max:500}),saturate_slide=new Slider({elem:sliderSaturate,filter:"saturate",max:200}),bright_slide=new Slider({elem:sliderBright,filter:"bright",max:200});function Filter(e,t,n){t=t,n=n,e.style.filter="brightness("+t+"%) saturate("+n+"%)"}function Bright(e,t){e.style.filter="brightness("+t+"%)",console.log("bright: "+t+"%")}function Saturate(e,t){e.style.filter="saturate("+t+"%)",console.log("saturate: "+t+"%")}function Crop(e,t){t=(t+100)/100,e.style.transform="scale("+t+")",console.log("crop "+t)}function deselectAllFilter(e){for(var t=0;t<e.children.length;t++)e.children[t].classList.remove("photo-editor__control--active")}document.addEventListener("crop",function(e){Crop(edit_img,e.detail.pos),e.detail.pos>0?(edit_img.addEventListener("mousedown",dragImage),edit_img.addEventListener("touchstart",dragImage)):(edit_img.removeEventListener("mousedown",dragImage),edit_img.removeEventListener("touchstart",dragImage)),console.log("filt: "+e.detail.filt_type+" slide: "+e.detail.pos)}),document.addEventListener("bright",function(e){Bright(edit_img,e.detail.pos),console.log("filt: "+e.detail.filt_type+" slide: "+e.detail.pos)}),document.addEventListener("saturate",function(e){Saturate(edit_img,e.detail.pos),console.log("filt: "+e.detail.filt_type+" slide: "+e.detail.pos)});var filter_control_list=document.getElementsByClassName("photo-editor__controls-list")[0];filter_control_list.onclick=function(e){var t=e.target;console.log(t.tagName),t.closest(".photo-editor__btn")&&(deselectAllFilter(this),t.closest(".photo-editor__control").classList.add("photo-editor__control--active")),t.closest(".photo-editor__btn--crop")?(edit_img.addEventListener("mousedown",dragImage),edit_img.addEventListener("touchstart",dragImage)):(edit_img.removeEventListener("mousedown",dragImage),edit_img.removeEventListener("touchstart",dragImage))};var btn_cancel=document.getElementById("btn_cancel");function Slider(e){var t,n,o,i,a=e.elem,s=a.querySelector(".photo-editor__thumb"),r=e.max||100;function l(e,t){var n;a.dispatchEvent(new CustomEvent(e,{bubbles:!0,detail:{pos:(n=t,Math.round(n/i)),filt_type:e}}))}function d(n){!function(n){var i=n-o-t.left;i<0&&(i=0);var r=a.offsetWidth-s.offsetWidth;i>r&&(i=r),s.style.left=i+"px",l(e.filter,i)}(n.clientX||n.touches[0].clientX)}function c(){document.removeEventListener("mousemove",d),document.removeEventListener("mouseup",c),document.removeEventListener("touchmove",d),document.removeEventListener("touchend",c)}a.ondragstart=function(){return!1},a.ontouchstart=a.onmousedown=function(e){if(console.log(e.target.className),e.target.classList.contains("photo-editor__thumb")){var l=e.clientX||e.touches[0].clientX;e.clientY||e.touches[0].clientY;return i=(a.offsetWidth-s.offsetWidth)/r,console.log("pixelsPerValue "+i),m=l,n=s.getBoundingClientRect(),t=a.getBoundingClientRect(),o=m-n.left,document.addEventListener("mousemove",d),document.addEventListener("mouseup",c),document.addEventListener("touchmove",d),document.addEventListener("touchend",c),!1}var m},this.setValue=function(t){var n=i*t;s.style.left=n+"px",l(e.filter,n)}}btn_cancel.onclick=function(){crop_slide.setValue(0),saturate_slide.setValue(100),bright_slide.setValue(100)};var translateX=0,translateY=0;function dragImage(e){var t,n,o=e.clientX||e.touches[0].clientX,i=e.clientY||e.touches[0].clientY;document.ontouchmove=document.onmousemove=function(e){var a=e.clientX||e.touches[0].clientX,s=e.clientY||e.touches[0].clientY;t=translateX+a-o,n=translateY+s-i,edit_img.style.transform="translate("+t+"px,"+n+"px)"},document.ontouchend=document.onmouseup=function(){translateX=t,translateY=n,document.onmousemove=document.onmouseup=null,document.ontouchmove=document.ontouchend=null},e.preventDefault()}function getCoords(e){var t=e.getBoundingClientRect();return{top:t.top+pageYOffset,left:t.left+pageXOffset}}edit_img.ondragstart=function(){return!1};